<UserControl x:Class="AIWeather.AIWeatherOptionsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:AIWeather"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="200"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Header -->
        <TextBlock Grid.Row="0" Grid.ColumnSpan="2" 
                   Text="All Sky Camera Weather Monitor Settings" 
                   FontSize="16" FontWeight="Bold" 
                   Margin="0,0,0,20"/>

        <!-- RTSP URL -->
        <TextBlock Grid.Row="1" Grid.Column="0" 
                   Text="RTSP Stream URL:" 
                   VerticalAlignment="Center" 
                   Margin="0,5"/>
        <TextBox Grid.Row="1" Grid.Column="1" 
                 Text="{Binding RtspUrl, UpdateSourceTrigger=PropertyChanged}" 
                 Margin="5" 
                 ToolTip="Enter the RTSP stream URL of your all-sky camera (e.g., rtsp://192.168.1.28/stream)"/>

        <!-- RTSP Username -->
        <TextBlock Grid.Row="2" Grid.Column="0" 
                   Text="RTSP Username:" 
                   VerticalAlignment="Center" 
                   Margin="0,5"/>
        <TextBox Grid.Row="2" Grid.Column="1" 
                 Text="{Binding RtspUsername, UpdateSourceTrigger=PropertyChanged}" 
                 Margin="5" 
                 ToolTip="Username for RTSP authentication (leave empty if not required)"/>

        <!-- RTSP Password -->
        <TextBlock Grid.Row="3" Grid.Column="0" 
                   Text="RTSP Password:" 
                   VerticalAlignment="Center" 
                   Margin="0,5"/>
        <PasswordBox Grid.Row="3" Grid.Column="1" 
                     x:Name="RtspPasswordBox"
                     Margin="5" 
                     PasswordChanged="RtspPasswordBox_PasswordChanged"
                     Loaded="RtspPasswordBox_Loaded"
                     ToolTip="Password for RTSP authentication (leave empty if not required)"/>

        <!-- Check Interval -->
        <TextBlock Grid.Row="4" Grid.Column="0" 
                   Text="Check Interval (minutes):" 
                   VerticalAlignment="Center" 
                   Margin="0,5"/>
        <TextBox Grid.Row="4" Grid.Column="1" 
                 Text="{Binding CheckIntervalMinutes, UpdateSourceTrigger=PropertyChanged}" 
                 Margin="5"
                 ToolTip="How often to check the weather conditions (in minutes, 1-60)"/>

        <!-- Cloud Coverage Threshold -->
        <TextBlock Grid.Row="5" Grid.Column="0" 
                   Text="Cloud Coverage Threshold (%):" 
                   VerticalAlignment="Center" 
                   Margin="0,5"/>
        <TextBox Grid.Row="5" Grid.Column="1" 
                 Text="{Binding CloudCoverageThreshold, UpdateSourceTrigger=PropertyChanged}" 
                 Margin="5"
                 ToolTip="Maximum cloud coverage percentage considered safe for imaging (0-100)"/>

        <!-- Separator -->
        <Separator Grid.Row="6" Grid.ColumnSpan="2" Margin="0,20,0,10"/>

        <!-- Use GitHub Models -->
        <TextBlock Grid.Row="7" Grid.Column="0" 
                   Text="Use GitHub Models AI:" 
                   VerticalAlignment="Center" 
                   Margin="0,5"/>
        <CheckBox Grid.Row="7" Grid.Column="1" 
                  IsChecked="{Binding UseGitHubModels}" 
                  VerticalAlignment="Center" 
                  Margin="5"
                  ToolTip="Enable GitHub Models for advanced AI weather analysis (supports Claude, GPT-4, Gemini)"/>

        <!-- Model Selection -->
        <TextBlock Grid.Row="8" Grid.Column="0" 
                   Text="AI Model:" 
                   VerticalAlignment="Center" 
                   Margin="0,5"/>
        <ComboBox Grid.Row="8" Grid.Column="1"
                  SelectedValue="{Binding SelectedModel, Mode=TwoWay}" 
                  SelectedValuePath="Tag"
                  IsEnabled="{Binding UseGitHubModels}"
                  Margin="5" 
                  ToolTip="Select the AI model to use for weather analysis">
            <ComboBoxItem Content="GPT-4o (OpenAI)" Tag="gpt-4o"/>
            <ComboBoxItem Content="GPT-4o Mini (OpenAI)" Tag="gpt-4o-mini"/>
            <ComboBoxItem Content="Claude 3.5 Sonnet (Anthropic)" Tag="claude-3.5-sonnet"/>
            <ComboBoxItem Content="Gemini 1.5 Flash (Google)" Tag="gemini-1.5-flash"/>
            <ComboBoxItem Content="Gemini 1.5 Pro (Google)" Tag="gemini-1.5-pro"/>
        </ComboBox>

        <!-- GitHub Token -->
        <TextBlock Grid.Row="9" Grid.Column="0" 
                   Text="GitHub Token:" 
                   VerticalAlignment="Center" 
                   Margin="0,5"/>
        <TextBox Grid.Row="9" Grid.Column="1" 
                 Text="{Binding GitHubToken, UpdateSourceTrigger=PropertyChanged}"
                 IsEnabled="{Binding UseGitHubModels}"
                 Margin="5" 
                 ToolTip="GitHub Personal Access Token with model access (get from github.com/settings/tokens)"/>

        <!-- Info Panel -->
        <Border Grid.Row="10" Grid.ColumnSpan="2"
                BorderThickness="1"
                Margin="0,20,0,0"
                Padding="10">
            <StackPanel>
                <TextBlock Text="ℹ️ About This Plugin" FontWeight="Bold" Margin="0,0,0,10"/>
                <TextBlock TextWrapping="Wrap">
                    This plugin monitors your all-sky camera and uses AI to determine weather conditions.
                    It integrates with NINA's safety monitoring system to automatically pause or stop imaging
                    when conditions become unsafe (clouds, rain, etc.).
                </TextBlock>
                <TextBlock TextWrapping="Wrap" Margin="0,10,0,0">
                    <Bold>Local AI:</Bold> Uses basic image processing to detect clouds, fog, and rain.
                </TextBlock>
                <TextBlock TextWrapping="Wrap" Margin="0,5,0,0">
                    <Bold>GitHub Models:</Bold> Advanced AI analysis using Claude, GPT-4, or Gemini (free for development, requires GitHub token).
                </TextBlock>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>
